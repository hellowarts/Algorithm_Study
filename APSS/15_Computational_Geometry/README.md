# 15장 계산 기하
## 15.1 도입
<p>계산 기하는 굉장히 많은 주제를 포함하는 광범위한 학문이지만 프로그래밍 대회 레벨에서는 대개 학부 선형 대수나 고등학교 수준의 기하학을 코드로 구현할 수 있는 능력이 중요하다.</p>
<p>이 장에서는 프로그래밍 대회에서 주로 출제되는 2차원 기하학만을 다룬다.</p>

## 15.2 계산 기하의 도구들
<p>계산 기하를 이용하는 코드를 구현할 때 필수적으로 사용하는 개념들의 정의와 구현 방식들을 소개한다.</p>

### 15.2.1 벡터의 구현
<p>벡터의 방향과 거리를 모두 알 고 있느면 두 점 사이의 상대적인 위치를 정확히 표시할 수 있다.</p>
<p>벡터를 표현하기 위해서 벡터의 시작점은 바뀌어도 벡터가 변하지는 않기 때문에 시작점을 항상 좌표 공간의 원점으로 정한다.</p>
<p>고로 벡터는 끝점의 위치 (x, y)로만 표현할 수 있다.</p>
<p><a href="https://github.com/hellowarts/Algorithm_Study/blob/main/APSS/15_Computational_Geometry/vector2.cpp">vector2.cpp</a>에 아래의 벡터 연산들이 구현되어 있다.</p>

+ 벡터의 덧셈, 뺄셈, 실수와의 곱셈
+ 벡터 끼리의 대소 비교
+ 벡터의 길이 (norm)
+ 벡터의 단위 벡터
+ 벡터의 polar
+ 벡터의 내적, 외적
+ 벡터의 사영 (project)

### 15.2.2 점과 직선, 선분의 표현
<p>벡터를 이용하면 점, 직선, 선분을 쉽게 표현 가능하다.</p>

+ 점 : 해당 점을 끝 점으로 삼는 벡터로 표현
+ 선분 : 두 개의 끝 점을 두 개의 벡터로 표현
+ 직선 : 직선에 포함된 임의의 선분을 이용해 표현

<p>물론 이 같은 표현을 단순히 x, y의 변수 값으로 표현할 수도 있지만 이와 같은 방식보다 벡터를 기준으로 생각하는 것이 많은 경우 코드를 간결하게 하고 문제를 푸는데 강력한 도구가 된다.</p>
<p>아래 코드는 vector2를 사용하여 세 개의 점 p, a, b가 주어졌을 때 a가 b보다 p에 얼마나 더 가까운지 반환하는 함수이다.</p>

``` cpp
// a가 b보다 p에 얼마나 가까운지 벡터로 표현
double howMuchCloser(vector2 p, vector2 a, vector2 b) {
    return (b - p).norm() - (a - p).norm();
}
```

<p>반면 각 점을 두 개의 실수로 표현한다면 아래와 같은 코드를 짜야 한다.</p>

``` cpp
// 위 함수에서 점을 2개의 실수로 표현할 경우
double howMuchCloser(double px, double py, double ax, 
                     double ay, double bx, double by) {
    return hypot(bx - px, by - py) - hypot(ax - px, ay - py);
}
```

### 15.2.3 벡터의 내적
<p>두 2차원 벡터 a = (ax, ay)와 b = (bx, by)의 내적 a . b는 다음과 같이 두 가지 방법으로 계산할 수 있는 실수 값이다.</p>

+ a . b = axbx + ayby
+ |a||b|cosΘ

<p>벡터의 내적이 의미 있는 것은 두 번째 정의에서 볼 수 있듯이 내적을 통해 두 벡터 사이의 각도를 알 수 있기 때문이다.</p>
<p>내적이 갖는 의미가 두 번째 식에 있다면, 실제 내적을 계산할 때는 첫 번째 식을 사용한다.</p>
<p>내적은 흔히 아래와 같은 용도로 사용된다.</p>

+ 벡터의 사이각 구하기 : 두 번째 정의에서 Θ만 남기고 반대쪽으로 다 넘겨서 구한다.
+ 벡터의 직각 여부 확인 : cosΘ = 0 이라면 Θ는 항상 직각(pi/2 or 3pi/2)일 수밖에 없다. 고로 내적이 0이면 두 벡터는 항상 직각이다.
+ 벡터의 사영 (project) : 벡터 a가 b 위에 드리우는 그림자 

### 15.2.4 벡터의 외적
<p>벡터의 외적은 사실 두 개의 3차원 벡터에 대해 정의되는 연산으로, 3차원 벡터 a, b가 주어졌을 때 이 두 벡터에 모두 수직인 다른 벡터를 반환한다.</p>
<p>하지만 모든 2차원 벡터는 z 좌표가 0인 3차원 벡터로 생각할 수 있기 때문에, 2차원 벡터에 대해서도 외적을 정의할 수 있다.</p>
<p>이때 우리가 눈여겨 볼 것은 외적에서의 벡터의 길이와 방향으로 외적은 다음과 같이 두 가지 방법으로 계산할 수 있다.</p>

+ a X b = axby - aybx
+ |a||b|sinΘ

<p>내적에서도 그랬듯이 첫 번째 정의는 외전을 계산하는 방법, 두 번째 정의는 외적을 계산하는 목적이 된다.</p>
<p>외적은 아래와 같은 용도로 사용된다.</p>

+ 면적 계산 : 외적의 절댓값이 a, b를 두 변으로 하는 평행 사변형의 넓이가 된다. (밑변: |b| X 높이 : |a|sinΘ), 절반으로 나누면 삼각형의 넓이도 계산 가능
+ 두 벡터의 방향 판별 : 외적의 값이 음수인지 양수인지에 따라 방향을 알 수 있음 (양수 : b가 a로부터 반시계 방향으로 180도 이내 존재, 음수 : b가 a로부터 시계 방향으로 180도 이내 존재)


``` cpp
// 원점에서 벡터 b가 벡터 a의 반시계 방향이면 양수, 시계 방향이면 음수, 평행이면 0을 반환
double ccw(vector2 a, vector2 b) {
    return a.cross(b);
}
// 점 p를 기준으로 벡터 b가 벡터 a의 반시계 방향이면 양수, 시계 방향이면 음수, 평행이면 0을 반환
double ccw(vector2 p, vector2 a, vector2 b) {
    return ccw(a - p, b - p);
}
```

